{"version":3,"sources":["assets\\Scripts\\UI\\GameUIControl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { UIControl } from \"../../FrameWork/ui/UIControl\";\nimport IntensifyDataManager from \"../data/IntensifyDataManager\";\nimport ECSManager from \"../ECS/ECSManager\";\nimport { Intensify } from \"../Enum\";\nimport MapDataManager from \"../Manager/MapDataManager\";\nimport PlayerDataManager from \"../Manager/PlayerDataManager\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class GameUIControl extends UIControl {\n    private m_canMakeCount:number = 10;\n    private m_maxMakeCount:number = 10;\n    private m_hammerAction = false;\n    private m_waterAction = false;\n    private m_water:cc.Node = null;\n    private m_hammer:cc.Node = null;\n    private m_makeNumberLabel:cc.Label = null;\n    private m_cannonList = [];\n\n    onLoad () {\n        super.onLoad();\n        this.m_water=this.getChildByUrl(\"bottom/make/ui_build_water\");\n        this.m_hammer=this.getChildByUrl(\"bottom/make/ui_build_hammer\");\n        this.m_makeNumberLabel=this.getChildByUrl(\"bottom/make/num\").getComponent(cc.Label);\n\n        this.updateGameUI();\n\n        this.registerBottomBtn();\n    }\n\n    start () {\n        var _cannonList = MapDataManager.getInstance().getCurCannonPoint();\n        for (let i = 0; i < _cannonList.length; i++) {\n            this.m_cannonList[i] = this.createCannonData();\n            this.m_cannonList[i].pos = _cannonList[i];\n        }\n    }\n\n    createCannonData(){\n        var obj:any= {};\n        obj.pos = cc.v2(0,0);\n        obj.cannon = null;\n        return obj;\n    }\n\n    getCanMakeIndex(){\n        for (let i = 0; i < this.m_cannonList.length; i++) {\n            if(this.m_cannonList[i].cannon == null ){\n                return i;\n            }\n        }\n        return null;\n    }\n\n    addMakeNumber(){\n        this.m_canMakeCount++;\n        if( this.m_canMakeCount > this.m_maxMakeCount ){\n            this.m_canMakeCount = this.m_maxMakeCount;\n        }\n        this.updateMakeCount();\n    }\n\n    subMakeNumber(){\n        this.m_canMakeCount--;\n        if( this.m_canMakeCount < 0 ){\n            this.m_canMakeCount = 0;\n        }\n        if( !this.m_waterAction ){\n            this.m_water.height = 0;\n        }\n        this.updateMakeCount();\n    }\n\n    updateMakeCount(){\n        this.m_makeNumberLabel.string = '' + this.m_canMakeCount + '/' + this.m_maxMakeCount;\n    }\n\n    update (dt) {\n        if( this.m_canMakeCount < this.m_maxMakeCount){\n            this.m_water.height += dt*50;\n            this.m_waterAction = true;\n            if ( this.m_water.height >= 133 ){\n                this.addMakeNumber();\n                if( this.m_canMakeCount == this.m_maxMakeCount){\n                    this.m_water.height = 133;\n                    this.m_waterAction = false;\n                }else{\n                    this.m_water.height = 0;\n                }\n            }\n        }\n    }\n\n    updateGameUI(){\n        if( !this.m_waterAction ){\n            this.m_water.height = 0;\n        }\n        \n        var lv = PlayerDataManager.getInstance().getInternsifLevel(Intensify.INTENSIFY_KUORONG);\n        this.m_maxMakeCount = IntensifyDataManager.getInstance().getValue(Intensify.INTENSIFY_KUORONG,lv);\n        this.updateMakeCount();\n    }\n\n    registerBottomBtn(){\n        this.buttonAddClickEvent(\"bottom/make/make\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/make/autoMake\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/intensify\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/shop\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/destroy\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/cannon\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/task/bt\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/buffer/skill_coin0\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/buffer/skill_coin1\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/buffer/skill_coin2\",this.clickBtnEvent,this);\n        this.buttonAddClickEvent(\"bottom/buffer/skill_coin3\",this.clickBtnEvent,this);\n    }\n\n    async clickBtnEvent(btn:cc.Button){\n        console.log(\"clickBtnEvent\",btn.name);\n        if(\"make<Button>\"==btn.name){\n            var index = this.getCanMakeIndex();\n            if( index == null ){\n                return;\n            }\n            if( this.m_canMakeCount == 0){\n                return;\n            }\n            if(!this.m_hammerAction ){\n                var  rot1 = cc.rotateTo(0.2,-90);\n                var rot2 = cc.rotateTo(0.2,0);\n                var callFunc = cc.callFunc(function(){\n                    this.m_hammerAction = false;\n                }.bind(this));\n                var seq = cc.sequence(rot1,rot2,callFunc);\n                this.m_hammer.runAction(seq);\n\n                this.m_hammerAction = true;\n            }\n            \n            this.subMakeNumber();\n            \n            let cannonEntity=await ECSManager.getInstance().createCannonEntity(index,16);\n            this.m_cannonList[index].cannon=cannonEntity;\n        }\n        else if(\"autoMake<Button>\"==btn.name){\n\n        }\n        else if(\"intensify<Button>\"==btn.name){\n\n        }\n        else if(\"shop<Button>\"==btn.name){\n\n        }\n        else if(\"destroy<Button>\"==btn.name){\n\n        }\n        else if(\"cannon<Button>\"==btn.name){\n\n        }\n        else if(\"bt<Button>\"==btn.name){\n\n        }\n        else if(\"skill_coin0<Button>\"==btn.name){\n\n        }\n        else if(\"skill_coin1<Button>\"==btn.name){\n\n        }\n        else if(\"skill_coin2<Button>\"==btn.name){\n\n        }\n        else if(\"skill_coin3<Button>\"==btn.name){\n            \n        }\n\n    }\n\n}\n\n\n"]}