{"version":3,"sources":["assets\\Scripts\\UI\\IntensifyItemControl.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,4EAA4E;AAC5E,mBAAmB;AACnB,sFAAsF;AACtF,8BAA8B;AAC9B,sFAAsF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEtF,uEAAsE;AACtE,0DAAyD;AACzD,qEAAgE;AAChE,kEAA6D;AAEvD,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAkD,wCAAS;IAA3D;QAAA,qEA+FC;QA7FG,wBAAwB;QACxB,aAAO,GAAU,IAAI,CAAC;QACtB,YAAM,GAAW,IAAI,CAAC;QACtB,eAAS,GAAU,IAAI,CAAC;QACxB,gBAAU,GAAU,IAAI,CAAC;QACzB,qBAAe,GAAW,IAAI,CAAC;QAC/B,mBAAa,GAAU,IAAI,CAAC;QAC5B,UAAI,GAAQ,CAAC,CAAC;;IAsFlB,CAAC;IApFG,qCAAM,GAAN;QACI,iBAAM,MAAM,WAAE,CAAC;QACf,IAAI,CAAC,OAAO,GAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QACrE,IAAI,CAAC,MAAM,GAAC,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAChF,IAAI,CAAC,SAAS,GAAC,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QACxE,IAAI,CAAC,eAAe,GAAC,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAChF,IAAI,CAAC,aAAa,GAAC,IAAI,CAAC,aAAa,CAAC,+BAA+B,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE9F,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAC,IAAI,CAAC,SAAS,EAAC,IAAI,CAAC,CAAC;IACjE,CAAC;IAED,oCAAK,GAAL,UAAM,EAAE;QACJ,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;IACnB,CAAC;IAED,uCAAQ,GAAR,UAAS,GAAG;QACR,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,GAAG,CAAC;IAC9B,CAAC;IAED,wCAAS,GAAT;QACI,IAAI,IAAI,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9E,IAAI,IAAI,IAAI,IAAI;YAAE,OAAO;QACzB,IAAI,EAAE,GAAG,2BAAiB,CAAC,WAAW,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtE,IAAI,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE;YAC5B,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAA;YAC7B,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1C,OAAO;SACV;QACD,IAAI,WAAW,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAC,EAAE,CAAC,CAAC;QAC9E,IAAI,WAAW,GAAG,2BAAiB,CAAC,WAAW,EAAE,CAAC,UAAU,EAAE,CAAC;QAC/D,IAAI,WAAW,GAAG,WAAW,EAAC;YAC1B,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1C,OAAO;SACV;QAED,2BAAiB,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;QACxD,2BAAiB,CAAC,WAAW,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE7D,0BAA0B;QAC1B,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAEK,yCAAU,GAAhB;;;;;;wBACI,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,IAAI,CAAC;wBACrC,IAAI,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBAC9E,IAAI,IAAI,IAAI,IAAI;4BAAE,sBAAO;wBACrB,KAAK,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC,CAAC;wBACrE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;wBAEjB,QAAQ,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACrD,qBAAM,6BAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,EAAC,eAAe,EAAC,EAAE,CAAC,WAAW,CAAC,EAAA;;wBAA9F,WAAW,GAAC,SAAoG;wBAChH,KAAK,GAAG,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;wBACjD,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,KAAK,CAAC;wBAE5B,EAAE,GAAG,2BAAiB,CAAC,WAAW,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACtE,IAAI,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE;4BAC5B,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAA;4BAC7B,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,KAAK,CAAC;yBAC7C;wBACG,WAAW,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAC,EAAE,CAAC,CAAC;wBAC1E,WAAW,GAAG,2BAAiB,CAAC,WAAW,EAAE,CAAC,UAAU,EAAE,CAAC;wBAC/D,IAAI,WAAW,GAAG,WAAW,EAAC;4BAC1B,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,KAAK,CAAC;yBAC7C;wBACD,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,EAAE,GAAC,WAAW,CAAC;wBAC3C,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,GAAC,CAAC,EAAE,GAAC,CAAC,CAAC,CAAC;wBAEjC,KAAK,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAC,EAAE,CAAC,CAAC;wBAClE,MAAM,GAAG,8BAAoB,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAC,EAAE,GAAC,CAAC,CAAC,CAAC;wBAErE,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;wBAC1B,aAAa,GAAE,EAAE,CAAC;wBACtB,IAAI,OAAO,EAAE;4BACT,aAAa,GAAC,GAAG,CAAC;yBACrB;wBAED,IAAI,MAAM,IAAI,IAAI,EAAE;4BAChB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,GAAC,KAAK,GAAC,aAAa,GAAC,QAAQ,CAAC;yBAC5D;6BAAI;4BACD,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,GAAC,KAAK,GAAC,aAAa,GAAC,KAAK,GAAC,MAAM,GAAC,aAAa,CAAC;yBAC9E;;;;;KAEJ;IA9FgB,oBAAoB;QADxC,OAAO;OACa,oBAAoB,CA+FxC;IAAD,2BAAC;CA/FD,AA+FC,CA/FiD,qBAAS,GA+F1D;kBA/FoB,oBAAoB","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { ResManagerPro } from \"../../FrameWork/manager/ResManagerPro\";\nimport { UIControl } from \"../../FrameWork/ui/UIControl\";\nimport IntensifyDataManager from \"../data/IntensifyDataManager\";\nimport PlayerDataManager from \"../Manager/PlayerDataManager\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class IntensifyItemControl extends UIControl {\n\n    // LIFE-CYCLE CALLBACKS:\n    m_title:cc.Label=null;\n    m_icon:cc.Sprite=null;\n    m_lvLabel:cc.Label=null;\n    m_preLabel:cc.Label=null;\n    m_upLevelButton:cc.Button=null;\n    m_needDiamond:cc.Label=null;\n    m_ID:number=0;\n\n    onLoad () {\n        super.onLoad();\n        this.m_title=this.getChildByUrl(\"item/title\").getComponent(cc.Label);\n        this.m_icon=this.getChildByUrl(\"item/ui_g_buildUpProb\").getComponent(cc.Sprite);\n        this.m_lvLabel=this.getChildByUrl(\"item/lv\").getComponent(cc.Label);\n        this.m_preLabel=this.getChildByUrl(\"item/value\").getComponent(cc.Label);\n        this.m_upLevelButton=this.getChildByUrl(\"item/upLevel\").getComponent(cc.Button);\n        this.m_needDiamond=this.getChildByUrl(\"item/upLevel/Background/Label\").getComponent(cc.Label);\n\n        this.buttonAddClickEvent(\"item/upLevel\",this.onClickUp,this);\n    }\n\n    setID(ID){\n        this.m_ID = ID;\n    }\n\n    setTitle(str){\n        this.m_title.string = str;\n    }\n\n    onClickUp(){\n        var data = IntensifyDataManager.getInstance().getIntensifyDataByID(this.m_ID);\n        if( data == null )return;\n        var lv = PlayerDataManager.getInstance().getInternsifLevel(this.m_ID);\n        if( lv >= data['value'].length ){\n            lv = data['value'].length - 1\n            this.m_upLevelButton.interactable = false;\n            return;\n        }\n        var needDiamond = IntensifyDataManager.getInstance().getDiamond(this.m_ID,lv);\n        var haveDiamond = PlayerDataManager.getInstance().getDiamond();\n        if( haveDiamond < needDiamond){\n            this.m_upLevelButton.interactable = false;\n            return;\n        }\n\n        PlayerDataManager.getInstance().subDiamond(needDiamond);\n        PlayerDataManager.getInstance().addInternsifLevel(this.m_ID);\n        \n        //g_gameUI.updateGameUI();\n        this.updateItem();\n    }\n\n    async updateItem(){\n        this.m_upLevelButton.interactable = true;\n        var data = IntensifyDataManager.getInstance().getIntensifyDataByID(this.m_ID);\n        if( data == null )return;\n        var title = IntensifyDataManager.getInstance().getTitle(this.m_ID,0);\n        this.setTitle(title);\n\n        var iconName = IntensifyDataManager.getInstance().getIcon(this.m_ID);\n        let gameUIAtlas=await ResManagerPro.Instance.IE_GetAsset(\"texture\",\"gameUI/gameUI\",cc.SpriteAtlas) as cc.SpriteAtlas;\n        var frame = gameUIAtlas.getSpriteFrame(iconName);\n        this.m_icon.spriteFrame = frame;\n\n        var lv = PlayerDataManager.getInstance().getInternsifLevel(this.m_ID);\n        if( lv >= data['value'].length ){\n            lv = data['value'].length - 1\n            this.m_upLevelButton.interactable = false;\n        }\n        var needDiamond = IntensifyDataManager.getInstance().getDiamond(this.m_ID,lv);\n        var haveDiamond = PlayerDataManager.getInstance().getDiamond();\n        if( haveDiamond < needDiamond){\n            this.m_upLevelButton.interactable = false;\n        }\n        this.m_needDiamond.string = ''+needDiamond;\n        this.m_lvLabel.string = 'Lv.'+(lv+1);\n\n        var curLv = IntensifyDataManager.getInstance().getValue(this.m_ID,lv);\n        var nextLv = IntensifyDataManager.getInstance().getValue(this.m_ID,lv+1);\n        \n        var showPer = data['showPer'];\n        var showPerString ='';\n        if( showPer ){\n            showPerString='%';\n        }\n\n        if( nextLv == null ){\n            this.m_preLabel.string = ''+curLv+showPerString+' - MAX';\n        }else{\n            this.m_preLabel.string = ''+curLv+showPerString+' - '+nextLv+showPerString;\n        }\n\n    }\n}\n"]}