{"version":3,"sources":["assets\\Scripts\\UI\\MapUIControl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { UIControl } from \"../../FrameWork/ui/UIControl\";\nimport DataManager from \"../data/DataManager\";\nimport PlayerDataManager from \"../Manager/PlayerDataManager\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class MapUIControl extends UIControl {\n\n    m_scrollView:cc.ScrollView=null;\n    m_onNode:cc.Node=null;\n    m_pointNode:cc.Node=null;\n    m_point:cc.Node=null;\n    m_curPoint:cc.Node=null;\n    m_bossView:cc.Node=null;\n    m_bg:cc.Node=null;\n\n    m_labGold:cc.Label=null;\n    m_labDiamond:cc.Label=null;\n\n    m_pointData=[];\n    m_curtPos:any=null;\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        super.onLoad();\n\n        this.m_scrollView=this.getChildByUrl(\"scrollview\").getComponent(cc.ScrollView);\n        this.m_onNode=this.getChildByUrl(\"scrollview/view/content\");\n        this.m_pointNode=this.getChildByUrl(\"scrollview/view/content/point\");\n        this.m_point=this.getChildByUrl(\"scrollview/view/content/point/point\");\n        this.m_curPoint=this.getChildByUrl(\"scrollview/view/content/point/curPoint\");\n        this.m_bossView=this.getChildByUrl(\"bossView\");\n        this.m_bg=this.getChildByUrl(\"bg\");\n\n        this.m_pointNode.zIndex = 1000;\n    }\n\n    updatePoint(){\n        while(this.m_pointNode.children.length){\n            var point = this.m_pointNode.children[0];\n            point.removeFromParent();\n            point.destroy();\n        }\n        for (let i = 0; i < this.m_pointData.length; i++) {\n            var pos = this.m_pointData[i];    \n            var node = cc.instantiate(this.m_point);\n            this.m_pointNode.addChild(node);\n            node.active = true;\n            node.setPosition(pos);\n        }\n        var node = cc.instantiate(this.m_curPoint);\n        this.m_pointNode.addChild(node);\n        node.active = true;\n        node.setPosition(this.m_curtPos);\n        this.curPointRunAction(node);\n    }\n\n    curPointRunAction(node){\n\n        var seq = cc.sequence(\n            cc.scaleTo(0.1,1.2,0.8),\n            cc.spawn(\n                cc.moveBy(0.2,cc.v2(0,30)),\n                cc.scaleTo(0.2,1,1),\n            ),\n            cc.spawn(\n                cc.moveBy(0.2,cc.v2(0,-30)),\n                cc.scaleTo(0.2,1.2,0.8),\n            ),\n            cc.scaleTo(0.1,1,1),\n            \n        );\n\n        node.runAction(cc.repeatForever(seq));\n    }\n\n    start () {\n\n    }\n\n    onClickDel(){\n        this.m_pointData.pop();\n        this.updatePoint();\n    }\n\n    onOut(){\n        var obj =[];\n        for( var i = 0;i < this.m_pointData.length;i++){\n            var pos=cc.v2();\n            pos.x = Math.floor(this.m_pointData[i].x) ;\n            pos.y = Math.floor(this.m_pointData[i].y) ;\n            obj.push(pos);\n        }\n        cc.log(JSON.stringify(obj));\n    }\n\n    show(){\n        this.m_bg.active = true;\n        this.m_bossView.active = false;\n        this.node.active = true;\n\n        this.m_pointData = [];\n        var checkPoint = PlayerDataManager.getInstance().getCheckPoint();\n        this.m_curtPos = DataManager.getInstance().checkPointNodePos[0];\n\n        if( checkPoint.big > 1 ){\n            for (let i = 0; i < checkPoint.big; i++) {\n                var pos = DataManager.getInstance().checkPointNodePos[i];\n                this.m_pointData.push(pos);\n            }\n        }\n        this.m_curtPos = DataManager.getInstance().checkPointNodePos[checkPoint.big];\n        this.updatePoint();\n\n        var value = this.m_curtPos.x - 640/2;\n        if( value < 0 ){\n            value = 0;\n        }\n        var pre = value / this.m_onNode.width;\n        this.m_scrollView.scrollToPercentVertical(pre);\n    }\n\n    hide(){\n        this.node.active = false;\n    }\n\n    onClickBG(){\n        this.hide();\n    }\n\n    showBossView(){\n        this.show();\n        this.m_bossView.active = true;\n        this.m_bg.active = false;\n    }\n\n    hideBossView(){\n        this.hide();\n        this.m_bossView.active = false;\n    }\n\n    goldFlyEnd(gold){\n        PlayerDataManager.getInstance().addGold(gold);\n        //g_gameUI.updateGameUI();\n    }\n\n    diamondFlyEnd(diamond){\n        PlayerDataManager.getInstance().addDiamond(diamond);\n        //g_gameUI.updateGameUI();\n    }\n\n    showSucceed(gold:number,diamond:number){\n        this.m_labGold.string = ''+gold.toString();\n        this.m_labDiamond.string = ''+diamond.toString();\n\n        this.showBossView();\n        var count = 50;\n        var createFly = function(){\n            if( gold > 0 ){\n                var addGold = Math.floor(gold/count) ;\n                //g_coinFly.createCoinToTip(this.m_labGold.node,this.goldFlyEnd.bind(this),addGold);\n            }\n            if( diamond > 0 ){\n                var addDiamond = Math.floor(diamond/count) ;\n                //g_diamondFly.createDiamondToTip(this.m_labDiamond.node,this.diamondFlyEnd.bind(this),addDiamond);\n            }\n        }\n        var actionList=[]\n        actionList.push(cc.delayTime(1));\n        for (let i = 0; i < count; i++) {\n            actionList.push(cc.delayTime(0.01));\n            actionList.push(cc.callFunc(createFly.bind(this)));\n        }\n        actionList.push(cc.callFunc(function(){\n            PlayerDataManager.getInstance().setGold(gold);\n            PlayerDataManager.getInstance().setDiamond(diamond);\n            //g_gameUI.updateGameUI();\n        }.bind(this)))\n        this.node.runAction(cc.sequence(actionList));\n        // this.m_labGold.string = numberToString(gold);\n    }\n}\n"]}