{"version":3,"sources":["assets\\Scripts\\GameApp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { EventManager } from \"../FrameWork/manager/EventManager\";\r\nimport { ResManager } from \"../FrameWork/manager/ResManager\";\r\nimport { UIManager } from \"../FrameWork/manager/UIManager\";\r\nimport Cmd from \"./Cmd\";\r\nimport Enum from \"./Enum\";\r\nimport Stype from \"./Stype\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameApp extends cc.Component {\r\n    private static _instance:GameApp=null\r\n    private canvas:cc.Node=null\r\n    private progressBar:cc.ProgressBar=null\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    public static getInstance():GameApp{\r\n        return GameApp._instance\r\n    }\r\n\r\n    public enterGame():void{\r\n        UIManager.getInstance().showUI(\"Login\",this.canvas)\r\n    }\r\n\r\n    public startGame():void{\r\n        //加载资源\r\n        let pkg={\r\n            \"prefabs\":cc.Prefab,\r\n            \"img\":cc.SpriteFrame,\r\n            \"Sounds\":cc.AudioClip,\r\n            \"data\":cc.TextAsset,\r\n            \"proto\":cc.TextAsset,\r\n            \"UI\":cc.BufferAsset\r\n            //\"UI\":[{assetType:cc.BufferAsset,urls:[\"Bag\"]},{assetType:cc.SpriteFrame,urls:[\"Bag_atlas0\"]}],\r\n        }\r\n        this.progressBar.progress=0\r\n        ResManager.getInstance().parsePkg(pkg,(cur,total)=>{\r\n            console.log(\"cur total\",cur,total)\r\n            this.progressBar.progress=cur*1.0/total\r\n        },()=>{\r\n            console.log(\"end\")\r\n            //加载游戏\r\n            this.progressBar.node.active=false\r\n\r\n            this.enterGame()\r\n        })\r\n    }\r\n\r\n    onLoad () {\r\n        if(null===GameApp._instance){\r\n            GameApp._instance=this\r\n        }\r\n        else{\r\n            this.destroy()\r\n            return\r\n        }\r\n\r\n        this.canvas=cc.find(\"Canvas\")\r\n        this.progressBar=this.canvas.getChildByName(\"ProgressBar\").getComponent(cc.ProgressBar)\r\n        this.progressBar.progress=0\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this,true)\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoved,this,true)\r\n        this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnded,this,true)\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this,true)\r\n    }\r\n\r\n    touchStart(e:cc.Event.EventTouch):void{\r\n        EventManager.getInstance().emit(Enum.EventName.TouchStart,e)\r\n    }\r\n\r\n    touchMoved(e:cc.Event.EventTouch):void{\r\n        EventManager.getInstance().emit(Enum.EventName.TouchMoved,e)\r\n    }\r\n\r\n    touchEnded(e:cc.Event.EventTouch):void{\r\n        EventManager.getInstance().emit(Enum.EventName.TouchEnded,e)\r\n    }\r\n\r\n    touchCancel(e:cc.Event.EventTouch):void{\r\n        EventManager.getInstance().emit(Enum.EventName.TouchCancel,e)\r\n    }\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}