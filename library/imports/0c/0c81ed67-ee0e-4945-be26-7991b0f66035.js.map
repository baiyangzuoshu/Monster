{"version":3,"sources":["assets\\FrameWork\\manager\\SoundManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nexport class SoundManager extends cc.Component {\r\n    private static MUTE_TAG=\"BGMUSIC_MUTE\"\r\n    private static _instance:SoundManager=null\r\n    public  static getInstance():SoundManager{\r\n        return SoundManager._instance\r\n    }\r\n\r\n    private audioEffect:Array<cc.AudioSource>=[]\r\n    private audioMax:number=8\r\n    private bgMusic:cc.AudioSource=null\r\n    private bgMusicMute:boolean=false\r\n    private curAudioEffect:number=0\r\n\r\n    onLoad(){\r\n        if(null==SoundManager._instance){\r\n            SoundManager._instance=this\r\n        }\r\n        else{\r\n            this.destroy()\r\n            return\r\n        }\r\n\r\n        for(let i=0;i<this.audioMax;i++){\r\n            let as:cc.AudioSource=this.node.addComponent(cc.AudioSource)\r\n            this.audioEffect.push(as)\r\n        }\r\n\r\n        this.bgMusic=this.node.addComponent(cc.AudioSource)\r\n        let value=localStorage.getItem(SoundManager.MUTE_TAG)\r\n        if(value){\r\n            let mute=parseInt(value)\r\n            this.bgMusicMute=mute==1\r\n        }\r\n    }\r\n\r\n    playBgMusic(clip:cc.AudioClip,isLoop:boolean):void{\r\n        this.bgMusic.stop()\r\n        \r\n        this.bgMusic.clip=clip\r\n        this.bgMusic.loop=isLoop\r\n        this.bgMusic.volume=1.0\r\n        this.bgMusic.play()\r\n    }\r\n\r\n    stopBgMusic():void{\r\n        this.bgMusic.stop()\r\n    }\r\n\r\n    playEffect(clip:cc.AudioClip):void{\r\n        let as=this.audioEffect[this.curAudioEffect]\r\n        as.clip=clip\r\n        as.loop=false\r\n        as.play()\r\n\r\n        this.curAudioEffect++\r\n        if(this.curAudioEffect>=this.audioMax){\r\n            this.curAudioEffect=0\r\n        }\r\n    }\r\n\r\n    playOneShotEffect(clip:cc.AudioClip,volumeScale?: number):void{\r\n        let as=this.audioEffect[this.curAudioEffect]\r\n        as.clip=clip\r\n        as.loop=false\r\n        //as.playOneShot(clip,volumeScale)\r\n\r\n        this.curAudioEffect++\r\n        if(this.curAudioEffect>=this.audioMax){\r\n            this.curAudioEffect=0\r\n        }\r\n    }\r\n\r\n    setBgMusicMute(mute:boolean):void{\r\n        if(this.bgMusicMute==mute){\r\n            return\r\n        }\r\n\r\n        let value=mute?\"1\":\"0\"\r\n        localStorage.setItem(SoundManager.MUTE_TAG,value)\r\n    }\r\n}\r\n\r\n"]}